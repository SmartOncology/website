
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The information we have: a digital elevation model &#8212; SmartOncology</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../_static/SmartOncoLogo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Aequidistant rectangular grids" href="cfd-01-rectangular-grid-genereation-python.html" />
    <link rel="prev" title="Important ressources" href="../A_overviews/psc_1dim_grid_.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/SmartOncoLogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SmartOncology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   SmartOncology
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  1 - Overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../A_overviews/psc_Recaman_Sequ_01.html">
   Recamán’s sequence - Logo of SmartOncology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A_overviews/psc_1dim_grid_.html">
   Important ressources
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  2 - User manual
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The information we have: a digital elevation model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cfd-01-rectangular-grid-genereation-python.html">
   Aequidistant rectangular grids
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cfd-02-body-fitted-grid-genereation-python.html">
   Python code for a terrain-following grid
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  3 - Technical manual
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../C_technical_manual/psc_interpolation_20.html">
   Types and test cases in 2-dimensional space
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C_technical_manual/cfd-03-grids-for-airfoils.html">
   Create your own NACA airfoil profile
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  4 - Project and community
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../D_project_and_community/psc_ArtPastell_11.html">
   Vectorized code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../D_project_and_community/psc_midpoint_1D_14.html">
   The steps to compute
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Visit our <a href="https://github.com/SmartOncology/Manuals-v0.1/">GitHub Repository</a><div> This book is powered by <a href="https://jupyterbook.org">Jupyter Book</a></div>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/source/B_user_manual/psc_matterhorn_evaluate_14.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   The information we have: a digital elevation model
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-model-how-to-instruct-your-robot">
   The model: how to instruct your robot
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-model-rule">
     The model rule
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-is-a-markov-chain-necessary">
     Why is a Markov Chain  necessary ?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-about-monte-carlo">
     What about Monte Carlo ?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-s-the-result">
     What’s the result ?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python-code">
     <em>
      Python code
     </em>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#graphics">
     <em>
      Graphics
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>Title: How to climb the Matterhorn with a Markov Chain Monte Carlo walk
Date: 2018-05-12 09:35
Category: MetaAnalysis
Tags: numerical, statistics, python, bayesian
Slug: Matterhorn-Markov-Chain-Monte-Carlo-walk-with-python
Cover: /posts/img2108/output_6_1.png
Authors: Peter Schuhmacher
Summary: We let your robot climb the Matterhorn with a Markov Chain Monte Carlo walk</p>
<div class="section" id="the-information-we-have-a-digital-elevation-model">
<h1>The information we have: a digital elevation model<a class="headerlink" href="#the-information-we-have-a-digital-elevation-model" title="Permalink to this headline">¶</a></h1>
<p>The Swiss national agency SWISSTOPO provides for demo purposes a digital elevation model (DEM) of the Matterhorn ( <a class="reference external" href="https://shop.swisstopo.admin.ch/en/products/height_models/dhm25">https://shop.swisstopo.admin.ch/en/products/height_models/dhm25</a> , see <em>‘Sample data’</em>). It’s a grid with 80 x 80 grid points. The grid size is 25 m. It covers an area of 2km x 2km with the peak of the Matterhorn in the center.</p>
<p>So the information we have is a table with figures indicating the <strong>height of topography</strong> at this piece of the earth:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Zinput</span><span class="p">[</span><span class="mi">33</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">33</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4277.008</td>
      <td>4309.786</td>
      <td>4341.514</td>
      <td>4363.104</td>
      <td>4370.490</td>
      <td>4376.302</td>
      <td>4372.981</td>
      <td>4394.396</td>
      <td>4414.586</td>
      <td>4427.304</td>
      <td>4434.690</td>
      <td>4429.183</td>
      <td>4400.208</td>
      <td>4283.695</td>
      <td>4238.506</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4278.494</td>
      <td>4299.690</td>
      <td>4311.097</td>
      <td>4326.480</td>
      <td>4330.588</td>
      <td>4326.087</td>
      <td>4318.002</td>
      <td>4320.187</td>
      <td>4345.885</td>
      <td>4364.590</td>
      <td>4392.385</td>
      <td>4389.282</td>
      <td>4402.699</td>
      <td>4325.082</td>
      <td>4254.982</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4246.285</td>
      <td>4269.186</td>
      <td>4277.401</td>
      <td>4291.387</td>
      <td>4292.304</td>
      <td>4286.710</td>
      <td>4274.080</td>
      <td>4272.682</td>
      <td>4268.005</td>
      <td>4284.613</td>
      <td>4306.595</td>
      <td>4324.514</td>
      <td>4330.414</td>
      <td>4302.881</td>
      <td>4264.597</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4214.993</td>
      <td>4238.681</td>
      <td>4246.197</td>
      <td>4260.488</td>
      <td>4257.517</td>
      <td>4256.293</td>
      <td>4245.498</td>
      <td>4232.780</td>
      <td>4207.520</td>
      <td>4223.690</td>
      <td>4228.804</td>
      <td>4228.017</td>
      <td>4194.409</td>
      <td>4223.603</td>
      <td>4214.906</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4179.200</td>
      <td>4205.815</td>
      <td>4215.518</td>
      <td>4229.416</td>
      <td>4222.204</td>
      <td>4223.297</td>
      <td>4218.402</td>
      <td>4201.096</td>
      <td>4148.695</td>
      <td>4143.582</td>
      <td>4141.484</td>
      <td>4120.201</td>
      <td>4107.308</td>
      <td>4099.398</td>
      <td>4115.087</td>
    </tr>
  </tbody>
</table>
</div>
<p>The isoline representation gives some more insight. The north-east crest (running from the top right corner to the peak of Matterhorn) is the <strong>Hörnligrat</strong>. It is the most often used ascent to the Matterhorn.</p>
<p>Even in the given representation with a spatial resolution of 25 m, the four main crests are clearly identifiable. The width of the crest has a scale of 2.5m which is fairly sharper than the gridsize of 25m.</p>
<p>At the top there is nothing like a plateau as one might belive due to isoline plot. This photo gives a certain impression about the real world situation: <a class="reference external" href="https://upload.wikimedia.org/wikipedia/commons/8/88/Summit_of_the_Matterhorn.jpg">https://upload.wikimedia.org/wikipedia/commons/8/88/Summit_of_the_Matterhorn.jpg</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_image_isoline</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_4_0.png" /></p>
</div>
<div class="section" id="the-model-how-to-instruct-your-robot">
<h1>The model: how to instruct your robot<a class="headerlink" href="#the-model-how-to-instruct-your-robot" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-model-rule">
<h2>The model rule<a class="headerlink" href="#the-model-rule" title="Permalink to this headline">¶</a></h2>
<p>Imagine you want to instruct your robot to explore the ascent to the peak of the Matterhorn: what rule do you implement the robot ?</p>
<p>Even if it sounds simple and stupide: <strong>“Go as steeply upward as you can”</strong> is a not too bad rule. Once on a crest it’s the safest ascent that mountaineers usually prefer. And on the crest the rule is almost perfect: The steepest ascent is the way upward. The way back descends, and to the right und to the left too.</p>
<p>In the following we implement a simplified variant: We give the robot a reasonable starting point at the foot of the crest. There is a more general approach: We might let it rain and follow the traces of the runoff. There where is almost no water, there are the crests.</p>
</div>
<div class="section" id="why-is-a-markov-chain-necessary">
<h2>Why is a Markov Chain  necessary ?<a class="headerlink" href="#why-is-a-markov-chain-necessary" title="Permalink to this headline">¶</a></h2>
<p>Because the famous crest always seen on any postcard, called Hörnli-Grat (Grat = crest), is <strong>not</strong> a random assembly of independent rocks ! Only some repeated and preferred transition probabilies from one point to the next gives something as a crest. Without that there is no crest, and the Hörnli-Grat would be Hörnli only (which is some sort of pasta in this region, usually called macaroni).</p>
<p>How can we use this feature for implementation ? We can consider the topographic height <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> as velocity potential. The drift (given as velocity vector <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>) toward the higher probability of being  a crest is given as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{u}  = \mathbf{\nabla H} = \left[\begin{matrix}\frac{\partial{H}}{\partial{x}} \\ \frac{\partial{H}}{\partial{y}}\end{matrix}\right]
\end{split}\]</div>
<p>An other approach is that we identify the regions of higher probability being a crest as the areas where the drift <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is convergent. The convergence <span class="math notranslate nohighlight">\(\gamma\)</span> is given as:</p>
<div class="math notranslate nohighlight">
\[
\gamma = -\mathbf{\nabla u}  = -\mathbf{\nabla(\nabla H)} = -\left(\begin{matrix}\frac{\partial^2{H}}{\partial{x^2}} + \frac{\partial^2{H}}{\partial{y^2}}\end{matrix}\right)
\]</div>
<p>For the latter approach we have mapped convergence <span class="math notranslate nohighlight">\(\gamma\)</span> (<em>not shown here</em>) which uses 2 grid length (= 50m) to compute. It seems that the grid size ist too coarse to give a good result.</p>
</div>
<div class="section" id="what-about-monte-carlo">
<h2>What about Monte Carlo ?<a class="headerlink" href="#what-about-monte-carlo" title="Permalink to this headline">¶</a></h2>
<p>We let your explorer robot explore the ascent over the crest several times. For that we add some random drift to the mean drift. The trace of the robot is then like a dog’s one looking for the trace of his master who is invisible hidden behind an obstacle: the running dog follows almost the master’s trace, but not always exactely.</p>
<p>There are some practical reasons for doing that, as (i) the starting point might not be ideal, so it’s better to adapt to a better trace. (ii) The crest may not always be a perfect crest. Our exploring robot had problems on the south-west crest, beceause the shoulder below the peak ressembles a plateau in the topographical data set, and the robot’s walk become stuck. With a good portion of Monte Carlo power the robot was able to overcome this passage.</p>
</div>
<div class="section" id="what-s-the-result">
<h2>What’s the result ?<a class="headerlink" href="#what-s-the-result" title="Permalink to this headline">¶</a></h2>
<p>The result is a 2-dimenaional PDF (probability density function) of the crests. So when you plan an expedition to the Matterhorn with 10 robots you may advise them to stay within the crest-PDF. For that you may implant them a <span class="xref myst">Metropolis-Hasting</span> chip in their GPS.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_trajectory</span><span class="p">(</span><span class="n">Xq</span><span class="p">,</span><span class="n">Yq</span><span class="p">,</span><span class="n">Zq</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_7_0.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Cp</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span> <span class="n">Cp</span><span class="p">[</span><span class="n">C</span><span class="o">&gt;</span><span class="mi">150</span><span class="p">]</span><span class="o">=</span><span class="mi">150</span><span class="p">;</span>
<span class="n">plot_distribution</span><span class="p">(</span><span class="n">Xq</span><span class="p">,</span><span class="n">Yq</span><span class="p">,</span><span class="n">Zq</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">Xq</span><span class="p">,</span><span class="n">Yq</span><span class="p">,</span><span class="n">Cp</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_8_0.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="section" id="python-code">
<h2><em>Python code</em><a class="headerlink" href="#python-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pyl</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LightSource</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#--- read the imput file ------------------</span>
<span class="n">f200name</span> <span class="o">=</span> <span class="s1">&#39;matterhorn25.asc&#39;</span>
<span class="n">nHead</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1">#first &#39;nHead&#39; rows to be skipped</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f200name</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f200</span><span class="p">:</span>
    <span class="n">Zinput</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f200</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="n">nHead</span><span class="p">)</span>
    <span class="n">mx</span><span class="p">,</span><span class="n">my</span> <span class="o">=</span> <span class="n">Zinput</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#--- compute the grid -------</span>
<span class="n">xZero</span> <span class="o">=</span> <span class="mf">615987.5</span>
<span class="n">yZero</span> <span class="o">=</span> <span class="mf">90487.5</span>
<span class="n">gridsize</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">gridsize</span><span class="p">,</span><span class="n">mx</span><span class="p">);</span>  <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>  <span class="n">x</span> <span class="o">=</span> <span class="n">xZero</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">gridsize</span><span class="p">,</span><span class="n">my</span><span class="p">);</span>  <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">yZero</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># X = ix.T * ones(iy)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># Y = ones(ix) * iy.T</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">Zinput</span>

<span class="c1">#--- unfortunately different systems have different matrix ordering......</span>
<span class="n">Xmg</span><span class="p">,</span><span class="n">Ymg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">Xm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">Xmg</span><span class="p">);</span>         <span class="n">Xn</span> <span class="o">=</span> <span class="n">Xmg</span><span class="p">;</span>                 <span class="n">Xq</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">Ym</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">Ymg</span><span class="p">);</span>         <span class="n">Yn</span> <span class="o">=</span> <span class="n">Ymg</span><span class="p">;</span>                 <span class="n">Yq</span> <span class="o">=</span> <span class="n">Y</span>
<span class="n">Zm</span> <span class="o">=</span> <span class="n">Zinput</span><span class="p">;</span>                 <span class="n">Zn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">Zinput</span><span class="p">);</span>   <span class="n">Zq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">Zinput</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- evaluate the potential -----------</span>
<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">dH</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">):</span>
    <span class="n">jx</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">jxm</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nx</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">jxp</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nx</span><span class="p">)</span>
    <span class="n">jy</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">jym</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ny</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">jyp</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ny</span><span class="p">)</span>
    
    <span class="n">Hx</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">H</span><span class="p">);</span>   <span class="n">Hy</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">Hxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">H</span><span class="p">);</span>   <span class="n">Hyy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>    
    
    <span class="n">Hx</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">jxp</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">-</span>  <span class="n">H</span><span class="p">[</span><span class="n">jxm</span><span class="p">,</span><span class="n">jy</span><span class="p">])</span>
    <span class="n">Hy</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jyp</span><span class="p">]</span> <span class="o">-</span>  <span class="n">H</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jym</span><span class="p">])</span>
    
    <span class="n">Hxx</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">jxp</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">H</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">H</span><span class="p">[</span><span class="n">jxm</span><span class="p">,</span><span class="n">jy</span><span class="p">])</span>
    <span class="n">Hyy</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jyp</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">H</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">H</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jym</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">Hx</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">Hy</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">Hxx</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">Hyy</span><span class="o">.</span><span class="n">T</span><span class="p">),</span>

<span class="n">Hx</span><span class="p">,</span><span class="n">Hy</span><span class="p">,</span> <span class="n">Hxx</span><span class="p">,</span> <span class="n">Hyy</span> <span class="o">=</span> <span class="n">dH</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- the trajectory model ------</span>
<span class="k">def</span> <span class="nf">inField</span><span class="p">(</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">jx</span><span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> 
    <span class="k">if</span> <span class="n">jx</span><span class="o">&gt;</span><span class="n">nx</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="kc">False</span>
    <span class="k">if</span> <span class="n">jy</span><span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> 
    <span class="k">if</span> <span class="n">jy</span><span class="o">&gt;</span><span class="n">ny</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="kc">False</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="k">def</span> <span class="nf">fem4</span><span class="p">(</span><span class="n">ξ</span><span class="p">,</span><span class="n">ν</span><span class="p">):</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ν</span><span class="p">);</span> <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ν</span><span class="p">)</span>
    <span class="n">f3</span> <span class="o">=</span> <span class="p">(</span><span class="n">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ν</span><span class="p">);</span>     <span class="n">f4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ξ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ν</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span>

<span class="k">def</span> <span class="nf">get_V</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
    <span class="n">ξ</span> <span class="o">=</span> <span class="p">(</span><span class="n">xp</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">jx</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">jx</span><span class="p">])</span>
    <span class="n">ν</span> <span class="o">=</span> <span class="p">(</span><span class="n">yp</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">jy</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">jy</span><span class="p">])</span>
    <span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span> <span class="o">=</span> <span class="n">fem4</span><span class="p">(</span><span class="n">ξ</span><span class="p">,</span><span class="n">ν</span><span class="p">)</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f3</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f4</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">vp</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+</span> <span class="n">f3</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f4</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">up</span><span class="p">,</span><span class="n">vp</span>

<span class="k">def</span> <span class="nf">get_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="n">jx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">xp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">jy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">yp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="n">inField</span><span class="p">(</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">):</span> 
        <span class="n">up</span><span class="p">,</span><span class="n">vp</span> <span class="o">=</span> <span class="n">get_V</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="n">C</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">up</span><span class="p">,</span><span class="n">vp</span><span class="p">,</span><span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="p">[],[],</span><span class="kc">False</span>

<span class="k">def</span> <span class="nf">run_randomWalk</span><span class="p">(</span><span class="n">nTraj</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>   
    <span class="k">def</span> <span class="nf">run_trajectories</span><span class="p">(</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iTraj</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTraj</span><span class="p">):</span>
            <span class="n">xp</span> <span class="o">=</span> <span class="n">xstart</span><span class="p">;</span>  <span class="n">yp</span> <span class="o">=</span> <span class="n">ystart</span>
            <span class="n">xtr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xp</span><span class="p">])</span>
            <span class="n">ytr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">yp</span><span class="p">])</span>
            <span class="n">runT</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">runT</span> <span class="o">&lt;</span> <span class="n">runTmax</span><span class="p">:</span>
                <span class="n">runT</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">up</span><span class="p">,</span><span class="n">vp</span><span class="p">,</span><span class="n">flag</span> <span class="o">=</span> <span class="n">get_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">runT</span> <span class="o">==</span> <span class="n">runTmax</span><span class="p">:</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                    <span class="n">upp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> 
                    <span class="n">vpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> 
                    <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">+</span> <span class="p">(</span><span class="n">up</span><span class="o">+</span><span class="n">upp</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>  <span class="n">xtr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xtr</span><span class="p">,</span> <span class="n">xp</span><span class="p">)</span>
                    <span class="n">yp</span> <span class="o">=</span> <span class="n">yp</span> <span class="o">+</span> <span class="p">(</span><span class="n">vp</span><span class="o">+</span><span class="n">vpp</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>  <span class="n">ytr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ytr</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="n">xts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xts</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xtr</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">yts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">yts</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ytr</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">break</span> 
        <span class="k">return</span> <span class="n">xts</span><span class="p">,</span><span class="n">yts</span>         
    <span class="n">xts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">yts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">runTmax</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="k">for</span> <span class="n">xstart</span><span class="p">,</span> <span class="n">ystart</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xStart</span><span class="p">,</span><span class="n">yStart</span><span class="p">):</span>
        <span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="o">=</span><span class="n">run_trajectories</span><span class="p">(</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">C</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#------ main: Random Walk ---------- </span>
<span class="n">xStart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">616750</span><span class="p">,</span> <span class="mi">617900</span><span class="p">,</span> <span class="mi">617950</span><span class="p">,</span> <span class="mi">616250</span><span class="p">])</span>
<span class="n">yStart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>  <span class="mi">90600</span><span class="p">,</span> <span class="mi">91250</span><span class="p">,</span>  <span class="mi">92400</span><span class="p">,</span>  <span class="mi">92400</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span>  <span class="n">Hy</span> 
<span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">Hx</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">Xq</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Yq</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">nx</span> <span class="o">=</span> <span class="n">mx</span><span class="p">;</span>  <span class="n">ny</span> <span class="o">=</span> <span class="n">my</span>

<span class="n">nTraj</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span> <span class="p">,</span><span class="mf">0.45</span><span class="p">,</span>  <span class="mf">25.755</span>
<span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">run_randomWalk</span><span class="p">(</span><span class="n">nTraj</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="section" id="graphics">
<h2><em>Graphics</em><a class="headerlink" href="#graphics" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_image_isoline</span><span class="p">(</span><span class="n">zImg</span><span class="p">,</span><span class="n">zIso</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span> 
    <span class="n">pyl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">zImg</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>   
    <span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">zIso</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matterhorn (grid size 25m x 25m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyl</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pyl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_trajectory</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">):</span> 
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span> 
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="c1">#q0 = ax1.quiver(X, Y, u, v, R, angles=&#39;xy&#39;, alpha=.92, cmap=plt.cm.plasma)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
        <span class="c1">#p = plt.quiverkey(q0,1,0.5,2,&quot;2 m/s&quot;,coordinates=&#39;data&#39;,color=&#39;r&#39;)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.65</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Some trajectories of Matterhorn Markov Chain Monte Carlo walk&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">xts</span><span class="p">,</span><span class="n">yts</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">C</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">):</span> 
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span> 
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="c1">#q0 = ax2.quiver(X, Y, u, v, R, angles=&#39;xy&#39;, alpha=.92, cmap=plt.cm.plasma)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;2 m/s&quot;</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span> <span class="n">C</span> <span class="p">,</span>  <span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PDF of Matterhorn crests&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hillshade</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">elevation</span><span class="p">):</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">azimuth</span> <span class="o">=</span> <span class="p">(</span><span class="mf">360.0</span> <span class="o">-</span> <span class="n">azimuth</span><span class="p">)</span><span class="o">*</span><span class="n">rad</span>
    <span class="n">elevation</span> <span class="o">=</span> <span class="n">elevation</span><span class="o">*</span><span class="n">rad</span> 
    
    <span class="n">hx</span><span class="p">,</span> <span class="n">hy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">slope</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">hx</span><span class="o">*</span><span class="n">hx</span> <span class="o">+</span> <span class="n">hy</span><span class="o">*</span><span class="n">hy</span><span class="p">))</span>
    <span class="n">aspect</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">hx</span><span class="p">,</span> <span class="n">hy</span><span class="p">)</span>

    <span class="n">grey_shading</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>\
                  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>\
                    <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">azimuth</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="n">aspect</span><span class="p">)</span>
    <span class="n">shaded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">grey_shading</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grey_shading</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotSurface</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">hShade</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">41</span><span class="p">))</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="n">LightSource</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
    <span class="n">rgb</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">shade</span><span class="p">(</span><span class="n">hShade</span><span class="p">,</span>  <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gist_earth</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">blend_mode</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">)</span>
    <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolors</span><span class="o">=</span><span class="n">rgb</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
    <span class="n">hight_angle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="n">rotation_angle</span> <span class="o">=</span> <span class="mi">120</span>  <span class="c1"># 0=von S; 90=von E; 180=von N</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">hight_angle</span><span class="p">,</span> <span class="n">rotation_angle</span><span class="p">)</span>
    
    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">);</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Y</span><span class="p">);</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="n">zmin</span><span class="p">,</span><span class="mf">1.1</span><span class="o">*</span><span class="n">zmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="sd">&#39;&#39;&#39;    </span>
<span class="sd">    plt.xlabel(r&#39;x (west --&gt; east)&#39;,  fontsize=40)</span>
<span class="sd">    plt.ylabel(r&#39;y (south --&gt; north)&#39;,fontsize=40)</span>
<span class="sd">    tickFontsize=40</span>
<span class="sd">    plt.xticks(fontsize = tickFontsize, rotation=270);</span>
<span class="sd">    plt.yticks(fontsize = tickFontsize, rotation= 90);</span>
<span class="sd">    plt.tick_params(which=&#39;major&#39;, length=20, width=10)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matterhorn&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">zShade</span> <span class="o">=</span> <span class="n">hillshade</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">plotSurface</span><span class="p">(</span><span class="n">Xq</span><span class="p">,</span><span class="n">Yq</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">zShade</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_23_0.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./source\B_user_manual"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../A_overviews/psc_1dim_grid_.html" title="previous page">Important ressources</a>
    <a class='right-next' id="next-link" href="cfd-01-rectangular-grid-genereation-python.html" title="next page">Aequidistant rectangular grids</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Peter Schuhmacher (PhD), Nikola Cihoric (MD)<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>