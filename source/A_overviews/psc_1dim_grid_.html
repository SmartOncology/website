
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Important ressources &#8212; SmartOncology</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../_static/SmartOncoLogo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The information we have: a digital elevation model" href="../B_user_manual/psc_matterhorn_evaluate_14.html" />
    <link rel="prev" title="Recamán’s sequence - Logo of SmartOncology" href="psc_Recaman_Sequ_01.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/SmartOncoLogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SmartOncology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   SmartOncology
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  1 - Overview
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="psc_Recaman_Sequ_01.html">
   Recamán’s sequence - Logo of SmartOncology
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Important ressources
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  2 - User manual
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../B_user_manual/psc_matterhorn_evaluate_14.html">
   The information we have: a digital elevation model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../B_user_manual/cfd-01-rectangular-grid-genereation-python.html">
   Aequidistant rectangular grids
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../B_user_manual/cfd-02-body-fitted-grid-genereation-python.html">
   Python code for a terrain-following grid
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  3 - Technical manual
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../C_technical_manual/psc_interpolation_20.html">
   Types and test cases in 2-dimensional space
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C_technical_manual/cfd-03-grids-for-airfoils.html">
   Create your own NACA airfoil profile
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  4 - Project and community
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../D_project_and_community/psc_ArtPastell_11.html">
   Vectorized code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../D_project_and_community/psc_midpoint_1D_14.html">
   The steps to compute
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Visit our <a href="https://github.com/SmartOncology/Manuals-v0.1/">GitHub Repository</a><div> This book is powered by <a href="https://jupyterbook.org">Jupyter Book</a></div>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/source/A_overviews/psc_1dim_grid_.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/SmartOncology/Manuals-v0.1/master?urlpath=tree/source/A_overviews/psc_1dim_grid_.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Important ressources
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#always-useful-scaling-to-0-1">
   Always useful: scaling to [0..1]
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simplify-the-world-model-the-distances">
   Simplify the world - model the distances
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#class-gridgeneration-1-dimensional-strechted-grids">
   class GridGeneration, 1-dimensional strechted grids
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-1-5-dimensional-finite-volume-fvm-grid">
   A 1.5-dimensional finite volume (FVM) grid
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#laminar-stationary-flow">
   Laminar stationary flow
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bernoulli-equation-from-energy-conservation">
     Bernoulli equation from energy conservation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bernoulli-equation-from-the-navier-stokes-equation">
     Bernoulli equation from the Navier Stokes equation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bernoulli-flow">
     Bernoulli flow
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-could-be-next">
   What could be next ?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>Title: Computational Fluid Dynamics 03: Streched 1.5-dimensional FVM grid with Bernoulli flow
Date: 2017-05-06 08:30
Category: ComputationalFluidDynamics
Tags: Python, grid generation
Slug: body-fitted-grid-genereation-python
Cover: /p5102/img5102/output_7_0.png
Authors: Peter Schuhmacher
Summary: We generate different types of stretched 1-dimensional grids. We use one of them to build a FVM grid and to analyze the Bernoulli flow.</p>
<div class="section" id="important-ressources">
<h1>Important ressources<a class="headerlink" href="#important-ressources" title="Permalink to this headline">¶</a></h1>
<p>This is a <strong>fundamental work</strong> with finite voume methd (FVM) in mind. It’s not easy to read. But if you want to know all…..</p>
<ul class="simple">
<li><p><strong>Joe E.Thompson, Z.U.A. Warsi and C. Wayne Mastin</strong></p></li>
<li><p>Numerical Grid Generation - Foundations and Applications</p></li>
<li><p><a class="reference external" href="https://epdf.pub/numerical-grid-generation.html">https://epdf.pub/numerical-grid-generation.html</a></p></li>
<li><p><a class="reference external" href="http://read.pudn.com/downloads218/ebook/1024406/GridGen_by_Thompson.pdf">http://read.pudn.com/downloads218/ebook/1024406/GridGen_by_Thompson.pdf</a></p></li>
<li><p><a class="reference external" href="https://www.amazon.it/Joe-F.-Thompson/e/B001HPOTHC%3Fref=dbs_a_mng_rwt_scns_share">https://www.amazon.it/Joe-F.-Thompson/e/B001HPOTHC?ref=dbs_a_mng_rwt_scns_share</a></p></li>
<li><p><a class="reference external" href="https://www.academia.edu/3193454/Numerical_grid_generation_foundations_and_applications">https://www.academia.edu/3193454/Numerical_grid_generation_foundations_and_applications</a></p></li>
</ul>
<p>Keep in mind this rules stemming from that book:</p>
<blockquote>
<div><p>The metric quantities should be represented numerically even when analytical expressions are available. One might have, for example,</p>
</div></blockquote>
<blockquote>
<div><p>If the metric coefficients were evaluated and stored at the grid points, it would perhaps be natural  using averages of the metric coefficients at the intermediate points. This, however, is not acceptable since it fails to satisfy the metric identity involved and thus would introduce spurious non-zero gradients in a uniform field.</p>
</div></blockquote>
<blockquote>
<div><p>Never average the metric coefficients. Rather, average the coordinate values themselves, if necessary, and then calculate the metric derivatives directly</p>
</div></blockquote>
<p>This is <strong>a fundamental work too</strong>, easier to follow and to read:</p>
<ul class="simple">
<li><p><strong>Knupp and Steinberg</strong>,</p></li>
<li><p>The fundamentals of grid generation</p></li>
<li><p><a class="reference external" href="https://www.researchgate.net/publication/265361548_The_Fundamentals_of_Grid_Generation">https://www.researchgate.net/publication/265361548_The_Fundamentals_of_Grid_Generation</a></p></li>
</ul>
<p>This is the <strong>BEST method for body-fitted structured grids</strong>:</p>
<ul class="simple">
<li><p><strong>Spreijkese</strong></p></li>
<li><p>original paper: <a class="reference external" href="https://core.ac.uk/download/pdf/80112194.pdf">https://core.ac.uk/download/pdf/80112194.pdf</a></p></li>
<li><p>similar: <em>- <a class="reference external" href="https://escholarship.org/content/qt25c7t89k/qt25c7t89k_noSplash_876eafce6a9dc328ea714341866fbd75.pdf">https://escholarship.org/content/qt25c7t89k/qt25c7t89k_noSplash_876eafce6a9dc328ea714341866fbd75.pdf</a></em></p></li>
</ul>
<p>Also, his distinction in</p>
<ul class="simple">
<li><p>computational grid</p></li>
<li><p>parameter grid</p></li>
<li><p>physical grid</p></li>
</ul>
<p>is helpful and clarifying.</p>
<p>Here are some more helpful ressources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://epdf.tips/queue/handbook-of-grid-generation.html">https://epdf.tips/queue/handbook-of-grid-generation.html</a></p></li>
<li><p><a class="reference external" href="https://epdf.tips/basic-structured-grid-generation-with-an-introduction-to-unstructured-grid-gener.html">https://epdf.tips/basic-structured-grid-generation-with-an-introduction-to-unstructured-grid-gener.html</a></p></li>
<li><p><a class="reference external" href="https://www.researchgate.net/publication/319562452_Application_of_numerical_grid_generation_for_improved_CFD_analysis_of_multiphase_screw_machines">https://www.researchgate.net/publication/319562452_Application_of_numerical_grid_generation_for_improved_CFD_analysis_of_multiphase_screw_machines</a></p></li>
<li><p><a class="reference external" href="http://inis.jinr.ru/sl/Simulation/Tannehill,_CFM_and_Heat_Transfer,2_ed/chap10.pdf">http://inis.jinr.ru/sl/Simulation/Tannehill,_CFM_and_Heat_Transfer,2_ed/chap10.pdf</a></p></li>
</ul>
</div>
<div class="section" id="always-useful-scaling-to-0-1">
<h1>Always useful: scaling to [0..1]<a class="headerlink" href="#always-useful-scaling-to-0-1" title="Permalink to this headline">¶</a></h1>
<p>In almost every circumstances it might be very helpful to squeeze your given array <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> into the interval <span class="math notranslate nohighlight">\([0..1]\)</span>. This can be achieved with:</p>
<div class="math notranslate nohighlight">
\[
\hat a = \frac{a-a_{min}}{a_{max} - a_{min}}
\]</div>
<p>Let’s start with the following example: Imagine <span class="math notranslate nohighlight">\(dx\)</span> are the random distances between the grid points of a 1-dimensional grid <span class="math notranslate nohighlight">\(x_p\)</span> with length <span class="math notranslate nohighlight">\(n_x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mclr</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span> <span class="o">=</span> <span class="mi">11</span>                                  <span class="c1"># number of grid points</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                <span class="c1"># random distances between the grid points</span>
<span class="n">dx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.483, 0.887, 0.228, 0.874, 0.311, 0.112, 0.534, 0.708, 0.639, 0.964])
</pre></div>
</div>
</div>
</div>
<p>We build a grid with consecutive grid points, starting at <span class="math notranslate nohighlight">\(0\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dx</span><span class="p">)]</span>             <span class="c1"># create an array with first element = 0, ...</span>
                                        <span class="c1"># ...and append the distances that are summed up</span>
<span class="n">x1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.   , 0.483, 1.37 , 1.598, 2.472, 2.784, 2.896, 3.43 , 4.138, 4.777, 5.742])
</pre></div>
</div>
</div>
</div>
<p>We want to keep the relative distances between the grid points but we would like to have them in the range between <span class="math notranslate nohighlight">\(0.5\)</span> and <span class="math notranslate nohighlight">\(2\)</span>. So scale it to <span class="math notranslate nohighlight">\([0 .. 1]\)</span> first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scale01</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>   <span class="c1">#--- transform z to [0 ..1]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">scale11</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>   <span class="c1">#--- transform z to [-1 ..1]</span>
    <span class="k">return</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">scale01</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span> <span class="o">=</span> <span class="n">scale01</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.   , 0.084, 0.239, 0.278, 0.431, 0.485, 0.504, 0.597, 0.721, 0.832, 1.   ])
</pre></div>
</div>
</div>
</div>
<p>And now we fit it into the range <span class="math notranslate nohighlight">\([0.5 .. 3]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x3</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">x2</span>
<span class="n">x3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.5  , 0.71 , 1.097, 1.196, 1.576, 1.712, 1.761, 1.994, 2.302, 2.58 , 3.   ])
</pre></div>
</div>
</div>
</div>
<p>Let’s plot it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- Graphics -------------------------------</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>              <span class="c1"># we will  need  y-coordinates</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x1: random&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y0</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x2: [0 .. 1]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y0</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x3: [0.5 .. 3]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random grid fitted into desired range&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/psc_1dim_grid__15_0.png" src="../../_images/psc_1dim_grid__15_0.png" />
</div>
</div>
</div>
<div class="section" id="simplify-the-world-model-the-distances">
<h1>Simplify the world - model the distances<a class="headerlink" href="#simplify-the-world-model-the-distances" title="Permalink to this headline">¶</a></h1>
<p>As we have seen just now: it’s easy to generate the distances between the grid points first and then to compute the grid points. It’s a good approach if you start your journey of grid generation in a <strong>heuristic and creative</strong> way. Your algorithms may then become more sophisticated step by step. So let’s start by generating a grid with variable spacing by the following idea:</p>
<ol class="simple">
<li><p>choose a minimal distance <span class="math notranslate nohighlight">\(dx_{min}\)</span> between the grid points as a threshold value and contro parameter</p></li>
<li><p>add some vairable spacing <span class="math notranslate nohighlight">\(dx_{var}\)</span> greater than zero to <span class="math notranslate nohighlight">\(dx_{min}\)</span></p></li>
<li><p>compute the grid points <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p>fit it into the desired range</p></li>
</ol>
<p>The smaller <span class="math notranslate nohighlight">\(dx_{min}\)</span> in relation to <span class="math notranslate nohighlight">\(dx_{var}\)</span> is the more pronounced is the grid strechting. Let’s try.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- main -----------------------------------------------------</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">55</span>                                   <span class="c1"># number of grid points</span>
<span class="n">ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                <span class="c1"># auxiliary computational grid</span>
<span class="n">dx_min</span> <span class="o">=</span> <span class="mf">0.2</span>                              <span class="c1"># minimal grid spacing as control parameter</span>
<span class="n">dx_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ix</span><span class="p">)</span>               <span class="c1"># variable spacing, large in the center, small at the boundaries</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">dx_min</span><span class="o">+</span><span class="n">dx_var</span>                        <span class="c1"># add the two spacings </span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">scale01</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dx</span><span class="p">)])</span>     <span class="c1"># compute the scaled grid points</span>
<span class="n">xp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.   , 0.004, 0.01 , 0.017, 0.026, 0.036, 0.047, 0.059, 0.073, 0.087, 0.103, 0.12 , 0.138, 0.158, 0.178, 0.199, 0.221, 0.243, 0.267, 0.291, 0.316, 0.341, 0.367, 0.393,
       0.42 , 0.446, 0.473, 0.5  , 0.527, 0.554, 0.58 , 0.607, 0.633, 0.659, 0.684, 0.709, 0.733, 0.757, 0.779, 0.801, 0.822, 0.842, 0.862, 0.88 , 0.897, 0.913, 0.927, 0.941,
       0.953, 0.964, 0.974, 0.983, 0.99 , 0.996, 1.   ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- grafics---------------------------------------------</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>                        <span class="c1"># we will  need  y-coordinates</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;fast&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x1: random&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Finer resolution at the boundaries&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/psc_1dim_grid__19_0.png" src="../../_images/psc_1dim_grid__19_0.png" />
</div>
</div>
</div>
<div class="section" id="class-gridgeneration-1-dimensional-strechted-grids">
<h1>class GridGeneration, 1-dimensional strechted grids<a class="headerlink" href="#class-gridgeneration-1-dimensional-strechted-grids" title="Permalink to this headline">¶</a></h1>
<p>We design now some basic types of grid stretching and collect them in a <code class="docutils literal notranslate"><span class="pre">class</span></code> so they can be called easily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GridGeneration</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>                            <span class="c1"># number of grid points in x-direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span>                            <span class="c1"># number of grid points in y-direction</span>
        
    <span class="c1">#===== scaling ====================================================================</span>
    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>          <span class="c1"># scale to [0..1]</span>
    
    <span class="c1">#===== computational space i ======================================================</span>
    <span class="c1">#--- ix, iy: index [0..1], [0..1]</span>
    <span class="k">def</span> <span class="nf">ix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">iy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
    
    <span class="c1">#==== 1-dim strechting functions ==================================================</span>
    <span class="c1">#--- a collection of 1D stretching functions</span>
    <span class="k">def</span> <span class="nf">stretch_regular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>                        <span class="c1">#---- regular equidistant grid</span>
        <span class="k">return</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">stretch_1_sin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>                          <span class="c1">#---- concentrate the grid points in the center</span>
        <span class="n">Lx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>                                          <span class="c1"># control parameter</span>
        <span class="n">ixx</span> <span class="o">=</span>  <span class="n">Lx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                      <span class="c1"># parameter grid</span>
        <span class="n">dxmin</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>                                        <span class="c1"># minimal distance as control parameter</span>
        <span class="n">dxvar</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ixx</span><span class="p">)</span>                             <span class="c1"># model the variable distances</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dxmin</span><span class="o">+</span><span class="n">dxvar</span><span class="p">)])</span>  <span class="c1"># compute the scaled grid points</span>
    <span class="k">def</span> <span class="nf">stretch_sin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>                            <span class="c1">#---- concentrate the grid points at the boundaries</span>
        <span class="n">Lx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>                                          <span class="c1"># control parameter</span>
        <span class="n">ixx</span> <span class="o">=</span>  <span class="n">Lx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                      <span class="c1"># parameter grid</span>
        <span class="n">dxmin</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>                                        <span class="c1"># minimal distance as control parameter</span>
        <span class="n">dxvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ixx</span><span class="p">)</span>                                 <span class="c1"># model the variable distances</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dxmin</span><span class="o">+</span><span class="n">dxvar</span><span class="p">)])</span>  <span class="c1"># compute the scaled grid points</span>
    <span class="k">def</span> <span class="nf">stretch_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>                            <span class="c1">#---- concentrate the grid points at one boundary</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>                           <span class="c1"># logical grid</span>
        <span class="n">yStretch</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">;</span> <span class="n">yOffset</span> <span class="o">=</span> <span class="mf">2.95</span>                      <span class="c1"># control parameters</span>
        <span class="n">ixx</span> <span class="o">=</span> <span class="n">yStretch</span><span class="o">*</span><span class="p">(</span><span class="n">yOffset</span><span class="o">+</span><span class="n">ix</span><span class="p">)</span>                         <span class="c1"># parameter grid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ixx</span><span class="o">**</span><span class="mi">2</span><span class="p">));</span>                  <span class="c1"># exp-stretching</span>
    <span class="k">def</span> <span class="nf">stretch_minusexpsquare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>                 <span class="c1">#---- concentrate the grid points at the boundaries</span>
        <span class="n">Lx</span><span class="p">,</span> <span class="n">Ax</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.5</span>                                     <span class="c1"># control parameters</span>
        <span class="n">ixx</span> <span class="o">=</span>  <span class="n">Lx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                     <span class="c1"># parameter grid</span>
        <span class="n">dxmin</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>                                        <span class="c1"># minimal distance as control parameter</span>
        <span class="n">dxvar</span> <span class="o">=</span> <span class="n">Ax</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ixx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                          <span class="c1"># model the variable distances</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dxmin</span><span class="o">+</span><span class="n">dxvar</span><span class="p">)])</span>  <span class="c1"># compute the scaled grid points</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- main -----------------------------------------------------</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">GridGeneration</span><span class="p">(</span><span class="n">nx</span> <span class="p">,</span><span class="n">ny</span><span class="p">)</span>

<span class="n">X0</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stretch_regular</span><span class="p">(</span><span class="n">nx</span><span class="p">);</span>  <span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>     <span class="c1"># regular grid</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stretch_sin</span><span class="p">(</span><span class="n">nx</span><span class="p">);</span>                            <span class="c1"># grid with higher resolution at the boundaries</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stretch_1_sin</span><span class="p">(</span><span class="n">nx</span><span class="p">);</span>                          <span class="c1"># grid with higher resolution at the center</span>
<span class="n">X3</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stretch_exp</span><span class="p">(</span><span class="n">nx</span><span class="p">);</span>                            <span class="c1"># grid with higher resolution at the lower/left end</span>
<span class="n">X4</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="o">-</span><span class="n">X3</span><span class="p">);</span>                                 <span class="c1"># grid with higher resolution at the higher/right end</span>
<span class="n">X5</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stretch_minusexpsquare</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>

<span class="c1">#---- grafics---------------------------------------------</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ms</span><span class="o">=</span><span class="mi">7</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span>  <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;regular grid&#39;</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y0</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(1-SIN)-stretching&#39;</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span><span class="n">Y0</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SIN-stretching&#39;</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span><span class="n">Y0</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EXP-stretching&#39;</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X4</span><span class="p">,</span><span class="n">Y0</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(1-EXP)-stretching&#39;</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X5</span><span class="p">,</span><span class="n">Y0</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(-EXP_square)-stretching&#39;</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>     <span class="c1">#  loc=&#39;upper right&#39;,prop={&#39;size&#39;: 15}</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;1-dimensional grid strechting&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mf">0.1</span> <span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/psc_1dim_grid__22_0.png" src="../../_images/psc_1dim_grid__22_0.png" />
</div>
</div>
</div>
<div class="section" id="a-1-5-dimensional-finite-volume-fvm-grid">
<h1>A 1.5-dimensional finite volume (FVM) grid<a class="headerlink" href="#a-1-5-dimensional-finite-volume-fvm-grid" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>for the <strong>cell centered FVM</strong> compute the corners/faces of the grid first. Then compute the grid points with the variables in the center of them</p></li>
<li><p>for the <strong>vertex centered FVM</strong> compute the grid points with the variables first. Then compute the corners/faces between them</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- main -----------------------------------------------------</span>
<span class="n">nxc</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">nxp</span> <span class="o">=</span> <span class="n">nxc</span><span class="o">-</span><span class="mi">1</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GridGeneration</span><span class="p">(</span><span class="n">nxc</span> <span class="p">,</span><span class="n">ny</span><span class="p">)</span>
<span class="n">xc</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">stretch_1_sin</span><span class="p">(</span><span class="n">nxc</span><span class="p">);</span>                          <span class="c1"># points at the corners/faces of the grid</span>
<span class="n">xp</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nxc</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">nxc</span><span class="p">])</span>                  <span class="c1"># ponts in the centers of the volumes</span>

<span class="n">S</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ix</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>                      <span class="c1"># size of the faces</span>
<span class="n">yc0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">S</span>                                        <span class="c1"># y-coord of the lower corner points</span>
<span class="n">yc1</span> <span class="o">=</span>  <span class="mf">0.5</span><span class="o">*</span><span class="n">S</span>                                        <span class="c1"># y-coord of the upper corner points</span>

<span class="c1">#---- grafics---------------------------------------------</span>
<span class="n">yc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ms</span><span class="o">=</span><span class="mi">7</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span>  <span class="s1">&#39;o--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;faces&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;center points&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc0</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;corners&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc0</span><span class="p">,</span><span class="n">yc1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ductus&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xc</span><span class="p">,</span><span class="n">xc</span><span class="p">],[</span><span class="n">yc0</span><span class="p">,</span><span class="n">yc1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;1.5-dimensional FVM grid&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\PC\AppData\Local\Temp/ipykernel_21136/1673676046.py:18: UserWarning: marker is redundantly defined by the &#39;marker&#39; keyword argument and the fmt string &quot;o--&quot; (-&gt; marker=&#39;o&#39;). The keyword argument will take precedence.
  ax.plot(xc,yc,  &#39;o--&#39;, lw=1 , marker=&#39;|&#39;, label=&#39;faces&#39;);
</pre></div>
</div>
<img alt="../../_images/psc_1dim_grid__24_1.png" src="../../_images/psc_1dim_grid__24_1.png" />
</div>
</div>
</div>
<div class="section" id="laminar-stationary-flow">
<h1>Laminar stationary flow<a class="headerlink" href="#laminar-stationary-flow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="bernoulli-equation-from-energy-conservation">
<h2>Bernoulli equation from energy conservation<a class="headerlink" href="#bernoulli-equation-from-energy-conservation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.schweizer-fn.de/stroemung/bernoulli/bernoulli.php">https://www.schweizer-fn.de/stroemung/bernoulli/bernoulli.php</a></p></li>
<li><p><a class="reference external" href="http://www.bakker.org/dartmouth06/engs150/04-clsfn.pdf">http://www.bakker.org/dartmouth06/engs150/04-clsfn.pdf</a></p></li>
<li><p><a class="reference external" href="https://www.stroemung-berechnen.de/bernoulligleichung/">https://www.stroemung-berechnen.de/bernoulligleichung/</a></p></li>
</ul>
<p>Now let’s analyze analytically the velocity and the pressure field. We assume a simple stationary laminar flow. We start with the energy conservation to derive the Bernoulli equation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{array}{rclcl}
\text{Flux} &amp; : &amp; H = \mathbf{S} \cdot \mathbf{v} &amp;  &amp; \\
\text{Mass conservation} &amp; : &amp; m = \mathbf{S} \cdot \mathbf{v} \cdot \rho &amp; = &amp;  const\\
\text{Energy conservation} &amp; : &amp; E = E_{kin} + E_{pot} + E_{pres} &amp; = &amp;  const\\
                           &amp; : &amp; E = \frac{1}{2}mv^2 + mgz + p \frac{m}{\rho} &amp; = &amp;  const\\
\text{Bernoulli equation}  &amp; : &amp; E/m = \frac{1}{2}v^2 + gz + p \frac{1}{\rho} &amp; = &amp;  const\\
\end{array}
\end{equation}
\end{split}\]</div>
<p>In our example we have no elevation <span class="math notranslate nohighlight">\(\Delta z\)</span> so we can neglect the potential energy. We can write the energy conservation in the two point form and find an iterative formula for the pressure <span class="math notranslate nohighlight">\(p\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{array}{rclcl}
\frac{1}{2}v_2^2 + p_2 \frac{1}{\rho} &amp; = &amp; \frac{1}{2}v_1^2 + p_1 \frac{1}{\rho}\\
\frac{1}{2}v_2^2 \rho + p_2  &amp; = &amp; \frac{1}{2}v_1^2 \rho + p_1 \\
p_2  &amp; = &amp;  p_1 + \frac{1}{2} \rho (v_1^2 - v_2^2) \\
\end{array}
\end{equation}
\end{split}\]</div>
</div>
<div class="section" id="bernoulli-equation-from-the-navier-stokes-equation">
<h2>Bernoulli equation from the Navier Stokes equation<a class="headerlink" href="#bernoulli-equation-from-the-navier-stokes-equation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.bakker.org/dartmouth06/engs150/04-clsfn.pdf">http://www.bakker.org/dartmouth06/engs150/04-clsfn.pdf</a></p></li>
<li><p><a class="reference external" href="https://www.continuummechanics.org/navierstokes.html">https://www.continuummechanics.org/navierstokes.html</a></p></li>
<li><p><a class="reference external" href="https://www.meteo.physik.uni-muenchen.de/lehre/roger/manuskripte/Fluid_Dynamics.pdf">https://www.meteo.physik.uni-muenchen.de/lehre/roger/manuskripte/Fluid_Dynamics.pdf</a></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{array}{rclcl}
\text{Navier Stokes equation} &amp; : &amp; \rho (\frac{\partial \mathbf{v}}{\partial t} + \mathbf{v} \nabla \mathbf{v}) = -\nabla p + \mu \nabla^2 \mathbf{v} + \rho \mathbf{f} &amp;  &amp; \\
\text{Euler equation} &amp; : &amp; \rho (\frac{\partial \mathbf{v}}{\partial t} + \mathbf{v} \nabla \mathbf{v}) = -\nabla p + \rho \mathbf{f} &amp; &amp; \\
\text{stationary Euler equation} &amp; : &amp; \mathbf{v} \nabla \mathbf{v} = -\frac{1}{\rho} \nabla p + \mathbf{f} &amp; &amp; \\
 &amp;  &amp;  &amp; Replacements &amp;   \mathbf{v} \nabla \mathbf{v} = \nabla ( \frac{1}{2} \mathbf{v}^2) \\
 &amp;  &amp;  &amp;              &amp; \frac{1}{\rho} \nabla p = \nabla \frac{p}{\rho} \\
 &amp;  &amp;  &amp;              &amp; \mathbf{f} = -\nabla gz \\
\text{stationary Euler equation} &amp; : &amp; \nabla ( \frac{1}{2} \mathbf{v}^2) + \nabla \frac{p}{\rho} + \nabla gz = 0 &amp; &amp; \\
                                 &amp; : &amp; \nabla ( \frac{1}{2} \mathbf{v}^2 + \frac{p}{\rho} + gz) = 0 &amp; &amp; \\
\text{Bernoulli equation}        &amp; : &amp;  \frac{1}{2} v^2 + \frac{p}{\rho} + gz = const &amp;  &amp; \\
\end{array}
\end{equation}
\end{split}\]</div>
</div>
<div class="section" id="bernoulli-flow">
<h2>Bernoulli flow<a class="headerlink" href="#bernoulli-flow" title="Permalink to this headline">¶</a></h2>
<p>the following marching algorithm:</p>
<ol class="simple">
<li><p>prescribe the flux <span class="math notranslate nohighlight">\(H\)</span> at the inlet or at the outlet boundary</p></li>
<li><p>evaluate the velocity with <span class="math notranslate nohighlight">\(u = H/S\)</span> at each cell face (mass conservation)</p></li>
<li><p>evaluate the profil of pressure <span class="math notranslate nohighlight">\(p\)</span> using the iterative formula (energy conservation)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">H</span><span class="o">/</span><span class="n">S</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nxc</span><span class="p">):</span>
    <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.000e+00,  3.408e-02,  5.469e-02,  6.726e-02,  7.476e-02,  7.875e-02,  8.000e-02,  7.875e-02,  7.476e-02,  6.726e-02,  5.469e-02,  3.408e-02,  2.082e-17, -5.757e-02,
       -1.562e-01, -3.224e-01, -5.748e-01, -8.610e-01, -1.000e+00, -8.610e-01, -5.748e-01, -3.224e-01, -1.563e-01, -5.757e-02, -5.551e-17])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#---- grafics---------------------------------------------</span>
<span class="n">yc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ms</span><span class="o">=</span><span class="mi">7</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span>  <span class="s1">&#39;o--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc0</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc1</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc0</span><span class="p">,</span><span class="n">yc1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xc</span><span class="p">,</span><span class="n">xc</span><span class="p">],[</span><span class="n">yc0</span><span class="p">,</span><span class="n">yc1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;velocity v&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;pressure p&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bernoulli flow&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">});</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\PC\AppData\Local\Temp/ipykernel_21136/1603144621.py:7: UserWarning: marker is redundantly defined by the &#39;marker&#39; keyword argument and the fmt string &quot;o--&quot; (-&gt; marker=&#39;o&#39;). The keyword argument will take precedence.
  ax.plot(xc,yc,  &#39;o--&#39;, lw=1 , marker=&#39;|&#39;);
</pre></div>
</div>
<img alt="../../_images/psc_1dim_grid__30_1.png" src="../../_images/psc_1dim_grid__30_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="what-could-be-next">
<h1>What could be next ?<a class="headerlink" href="#what-could-be-next" title="Permalink to this headline">¶</a></h1>
<p>There are different ways how you could continue your journey into computational fluid dynamics:</p>
<p>One thing are <strong>2-dimanional grids</strong>. The big deal is how determin the distribution of the interior grid points. With the stretched 1-dimensional grids as discussed here you are prepared to set the boundaries of a 2-dimensional grid.</p>
<p>An other thing is the <strong>physics of fluid dynamics</strong>. You might start to solve 1-dimensional diffusion and/or advection driven CFD problems. You will have to decide what type of discretization schema you prefer. <strong>FDM</strong> (finite differences method), <strong>FEM</strong> (finite element method) or <strong>FVM</strong> (finite volume method).</p>
<p>A third thing is the <strong>numerics of equation solvers</strong>. The easist approach is an explicit time marching FDM algorithm. Hower sooner are later you might prefer to solve a stationary equation or an inplicite time marching equation by an iterative matrix solver. You can develop some skills how to set up the sparse system equation.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./source\A_overviews"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="psc_Recaman_Sequ_01.html" title="previous page">Recamán’s sequence - Logo of SmartOncology</a>
    <a class='right-next' id="next-link" href="../B_user_manual/psc_matterhorn_evaluate_14.html" title="next page">The information we have: a digital elevation model</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Peter Schuhmacher (PhD), Nikola Cihoric (MD)<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>